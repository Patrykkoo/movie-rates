<%- include('partials/header') %>

<div class="page-intro">
    <h2>Mój Katalog</h2>
    <p>Twoje spersonalizowane listy filmów.</p>
</div>

<div class="tabs-container">
    <nav class="tab-nav">
        <button class="tab-link active" data-tab="to-watch-pane">Do obejrzenia</button>
        <button class="tab-link" data-tab="watched-pane">Obejrzane</button>
    </nav>

    <div class="tab-content">
        <div id="to-watch-pane" class="tab-pane active">
            <div class="movie-grid">
                <% if (toWatchMovies.length > 0) { %>
                    <% toWatchMovies.forEach(movie => { %>
                        <div class="movie-card">
                            <img src="<%= movie.posterUrl || 'https://placehold.co/400x600/2a2a2a/e0e0e0?text=Brak+plakatu' %>" alt="Plakat filmu <%= movie.title %>" class="movie-poster" onerror="this.onerror=null;this.src='https://placehold.co/400x600/2a2a2a/e0e0e0?text=Brak+plakatu';">
                            <div class="movie-details">
                                <h2 class="movie-title"><%= movie.title %></h2>
                                <p class="movie-meta"><%= movie.director %> | <%= movie.year %></p>
                                
                                <div class="movie-stats">
                                    <span class="icon-star"><%- '&#9733;' %></span>
                                    <span class="rating-value"><%= movie.averageRating ? movie.averageRating.toFixed(1) : 'Brak' %></span>
                                    <span class="review-count">(<%= movie.reviewCount %> recenzji)</span>
                                </div>

                                <div class="card-actions">
                                    <button class="btn btn-full details-btn" data-movie-id="<%= movie.id %>">Szczegóły</button>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p class="empty-collection-info">Brak filmów na liście "Do obejrzenia".</p>
                <% } %>
            </div>
        </div>

        <div id="watched-pane" class="tab-pane">
            <div class="movie-grid">
                <% if (watchedMovies.length > 0) { %>
                    <% watchedMovies.forEach(movie => { %>
                        <div class="movie-card">
                            <img src="<%= movie.posterUrl || 'https://placehold.co/400x600/2a2a2a/e0e0e0?text=Brak+plakatu' %>" alt="Plakat filmu <%= movie.title %>" class="movie-poster" onerror="this.onerror=null;this.src='https://placehold.co/400x600/2a2a2a/e0e0e0?text=Brak+plakatu';">
                            <div class="movie-details">
                                <h2 class="movie-title"><%= movie.title %></h2>
                                <p class="movie-meta"><%= movie.director %> | <%= movie.year %></p>
                                
                                <div class="movie-stats">
                                    <span class="icon-star"><%- '&#9733;' %></span>
                                    <span class="rating-value"><%= movie.averageRating ? movie.averageRating.toFixed(1) : 'Brak' %></span>
                                    <span class="review-count">(<%= movie.reviewCount %> recenzji)</span>
                                </div>

                                <div class="card-actions">
                                    <button class="btn btn-full details-btn" data-movie-id="<%= movie.id %>">Szczegóły</button>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p class="empty-collection-info">Brak filmów na liście "Obejrzane".</p>
                <% } %>
            </div>
        </div>
    </div>
</div>

<%- include('partials/movie-modal') %>
<%- include('partials/footer') %>

<script src="/js/tabs.js"></script>
<script src="/js/modal.js"></script>